
## Building and Running Locally

The `Makefile` contains helpers for testing the full solution locally using `k3d`. Run `make help` to see all the available options.

_If you choose to pull the images from the registry instead of building and loading first - you probably want to set `VERSION=latest` (or a previous version) in your environment also.
The `Makefile` is usually pointed at the next version to be released and published images may not exist yet_.

```bash
# Builds all the docker images (optional, they are also available in the github registry)
$> make build-all
# Spin up a kind cluster for local testing
$> make test-cluster
# Load all the docker images into the kind cluster (optional for same reason as build)
$> make load-all
# Deploy the manager, kvdi, and setup the example templates
$> make deploy example-vdi-templates
# To test using custom helm values
$> HELM_ARGS="-f my_values.yaml" make deploy
```

After the manager has started the `app` instance, get the IP of its service with `kubectl get svc` to access the frontend, or you can run `make-forward-app` to start a local port-forward.

If not using anonymous auth, look for `kvdi-admin-secret` to retrieve the `admin` password.


## Something that are under development

  - "App Profiles" - I have a POC implementation on `main` but it is still pretty buggy
  - DOSBox/Game profiles could be cool...same as "App Profiles"
  - ARM64 support. Should be easy, but the build files will need some shuffling.
  - UI could use a serious makeover from someone who actually knows what they are doing


## Bundle Manifest

There is a manifest in this repository that will **just** lay down the manager instance, its dependencies, and all of the CRDs. 
You can then create a [VDICluster](doc/appv1.md#VDIClusterSpec) object manually to spin up an actual application instance.

To install the manifest:

```bash
export KVDI_VERSION=v0.3.6

kubectl apply -f https://raw.githubusercontent.com/kvdi/kvdi/${KVDI_VERSION}/deploy/bundle.yaml --validate=false
```

## Kustomize

The `kustomize` manifests in this repository are generated by `kubebuilder` and are usable as well similar to the [Bundle Manifest](#bundle-manifest).
They can be found in the [config](config/) directory in this repository.